langcode: en
status: true
dependencies: {  }
id: stanford_localist_importer
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: {  }
migration_group: stanford_events
label: 'localist importer'
source:
  track_changes: true
  plugin: url
  data_fetcher_plugin: http
  urls: {  }
  data_parser_plugin: json
  item_selector: /event
  fields:
    -
      name: id
      label: ID
      selector: id
    -
      name: title
      label: Title
      selector: title
    -
      name: url
      label: url
      selector: url
    -
      name: updated_at
      label: 'Updated At'
      selector: updated_at
    -
      name: created_at
      label: 'Created At'
      selector: created_at
    -
      name: facebook_id
      label: 'Facebook ID'
      selector: facebook_id
    -
      name: first_date
      label: 'First Date'
      selector: first_date
    -
      name: last_date
      label: 'Last Date'
      selector: last_date
    -
      name: hashtag
      label: Hashtag
      selector: hashtag
    -
      name: urlname
      label: 'URL Name'
      selector: urlname
    -
      name: user_id
      label: 'User ID'
      selector: user_id
    -
      name: directions
      label: Directions
      selector: directions
    -
      name: location
      label: ''
      selector: location
    -
      name: room_number
      label: 'Room Number'
      selector: room_number
    -
      name: location_name
      label: 'Location Name'
      selector: location_name
    -
      name: status
      label: Status
      selector: status
    -
      name: experience
      label: Experience
      selector: experience
    -
      name: stream_url
      label: 'Stream URL'
      selector: stream_url
    -
      name: stream_info
      label: 'Stream Info'
      selector: stream_info
    -
      name: stream_embed_code
      label: 'Stream Embed Code'
      selector: stream_embed_code
    -
      name: created_by
      label: 'Created By'
      selector: created_by
    -
      name: updated_by
      label: 'Updated By'
      selector: updated_by
    -
      name: city_id
      label: 'City ID'
      selector: city_id
    -
      name: neighborhood_id
      label: 'Neighborhood ID'
      selector: neighborhood_id
    -
      name: school_id
      label: 'School ID'
      selector: school_id
    -
      name: campus_id
      label: 'Campus ID'
      selector: campus_id
    -
      name: recurring
      label: Recurring
      selector: recurring
    -
      name: free
      label: Free
      selector: free
    -
      name: private
      label: Private
      selector: private
    -
      name: verified
      label: Verified
      selector: verified
    -
      name: rejected
      label: Rejected
      selector: rejected
    -
      name: sponsored
      label: Sponsored
      selector: sponsored
    -
      name: venue_id
      label: 'Venue ID'
      selector: venue_id
    -
      name: ticket_url
      label: 'Ticket URL'
      selector: ticket_url
    -
      name: ticket_cost
      label: 'Ticket Cost'
      selector: ticket_cost
    -
      name: keywords
      label: 'Keywords Array'
      selector: keywords
    -
      name: tags
      label: 'Tags Array'
      selector: tags
    -
      name: description_text
      label: 'Description Plaintext'
      selector: description_text
    -
      name: photo_id
      label: 'Photo ID'
      selector: photo_id
    -
      name: detail_view
      label: 'Detail View'
      selector: detail_view
    -
      name: address
      label: 'Address'
      selector: address
    -
      name: description
      label: Description
      selector: description
    -
      name: featured
      label: Featured
      selector: featured
    -
      name: geo_latitude
      label: 'Geo Latitutde'
      selector: geo/latitude
    -
      name: geo_longituded
      label: 'Geo Longitude'
      selector: geo/longitude
    -
      name: geo_street
      label: 'Geo Street'
      selector: geo/street
    -
      name: geo_city
      label: 'Geo City'
      selector: geo/city
    -
      name: geo_state
      label: 'Geo State'
      selector: geo/state
    -
      name: geo_country
      label: 'Geo Country'
      selector: geo/country
    -
      name: geo_zip
      label: 'Geo Zip'
      selector: geo/zip
    -
      name: filters
      label: Filters
      selector: filters
    -
      name: custom_fields
      label: 'Custom Fields'
      selector: custom_fields
    -
      name: localist_url
      label: 'Localist URL'
      selector: localist_url
    -
      name: localist_ics_url
      label: 'Localist ICS URL'
      selector: localist_ics_url
    -
      name: photo_url
      label: 'Photo URL'
      selector: photo_url
    -
      name: venue_url
      label: 'Venue URL'
      selector: venue_url
    -
      name: event_instances
      label: 'Event Instances Array'
      selector: event_instances

  ids:
    event_id:
      type: string
    event_start:
      type: string
    event_end:
      type: string
  constants:
    status: 1
    type: stanford_event
    stanford_html: stanford_html
    stanford_minimal_html: stanford_minimal_html
    map_title: 'Open in map'
    image_path: 'public://events/'
process:
  status: constants/status
  type: constants/type
  title: title
  body/value: body
  body/format: constants/stanford_html
  su_event_email: contact_email
  su_event_telephone: contact_phone
  su_event_sponsor:
    -
      plugin: explode
      source: event_sponsor
      delimiter: ', '
      limit: 100
    -
      plugin: substr
      start: 0
      length: 120
    -
      plugin: callback
      callable: trim
  su_event_alt_loc: location
  su_event_map_link/uri: map_link
  su_event_map_link/title: constants/map_title
  su_event_source/uri: link
  su_event_date_time/value:
    -
      plugin: format_date
      source: event_start
      from_format: 'Y-m-d H:i:s O'
      to_format: U
      timezone: Etc/GMT
  su_event_date_time/end_value:
    -
      plugin: format_date
      source: event_end
      from_format: 'Y-m-d H:i:s O'
      to_format: U
      timezone: Etc/GMT
  su_event_date_time/duration:
    -
      plugin: stanford_events_datemath
      operation: subtraction
      source: event_end
      values:
        - event_start
  su_event_date_time/timezone: 'America/Los_Angeles'
  su_event_type:
    -
      plugin: explode
      source: categories
      delimiter: ','
    -
      plugin: array_shift
    -
      plugin: callback
      callable: trim
    -
      plugin: entity_generate
      access_check: false
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: stanford_event_types
      value_key: name
      ignore_case: true
  su_event_audience:
    -
      plugin: explode
      source: audience
      delimiter: ','
    -
      plugin: callback
      callable: trim
    -
      plugin: entity_generate
      access_check: false
      entity_type: taxonomy_term
      bundle_key: vid
      bundle: event_audience
      value_key: name
      ignore_case: true
destination:
  plugin: 'entity:node'
migration_dependencies: {  }
